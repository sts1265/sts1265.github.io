<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DMA Explorer Prototype</title>
  <style>
    :root {
      --primary: #0f2a44;
      --accent: #1f6feb;
      --bg-light: #f7f9fc;
      --border: #d6e0ef;
    }

    body { 
      margin: 0; 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      display: grid; 
      grid-template-columns: 280px 1fr 300px; 
      height: 100vh; 
      background: var(--bg-light); 
      overflow: hidden;
    }

    .left-panel { background: var(--primary); color: white; padding: 20px; overflow-y: auto; border-right: 1px solid #081a2b; }
    .left-panel h3 { margin-top: 0; color: #9ec3ff; font-size: 1.1rem; text-transform: uppercase; border-bottom: 1px solid #1f4c7a; padding-bottom: 10px; }
    
    .obligation-link { 
      display: block; 
      padding: 12px 15px; 
      margin-bottom: 10px; 
      background: #173a5e; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 0.85rem;
      border-left: 4px solid transparent;
      transition: background 0.2s;
    }
    .obligation-link:hover { background: #1f4c7a; }
    .obligation-link.active { background: var(--accent); border-left-color: white; }

    .center-panel { padding: 40px; overflow-y: auto; background: white; line-height: 1.6; color: #333; }
    .title { font-size: 24px; font-weight: 800; margin-bottom: 15px; color: var(--primary); }
    /* Added word-wrap to prevent long text from breaking layout */
    .provision-text { font-size: 1.05rem; white-space: pre-wrap; margin-top: 20px; word-wrap: break-word; }
    
    .link-section { margin: 20px 0; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee; }
    .ref-link { 
      display: inline-block;
      margin-right: 10px; 
      padding: 4px 12px;
      background: white;
      text-decoration: none; 
      color: var(--accent); 
      font-weight: 600; 
      cursor: pointer; 
      border-radius: 20px;
      font-size: 0.85rem;
      border: 1px solid var(--accent);
    }
    .ref-link:hover { background: var(--accent); color: white; }

    .right-panel { background: #eef3f9; border-left: 1px solid var(--border); padding: 20px; overflow-y: auto; }
    .resource-card { background: white; padding: 15px; border-radius: 8px; border: 1px solid var(--border); margin-top: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .resource-card a { display: inline-block; color: white; background: var(--accent); text-decoration: none; padding: 8px 12px; border-radius: 5px; font-size: 0.8rem; margin-top: 10px; }
    
    .empty-state { color: #888; font-style: italic; text-align: center; margin-top: 50px; }
  </style>
</head>
<body>

<div class="left-panel">
  <h3>DMA Explorer</h3>
  <div id="nav"></div>
</div>

<div class="center-panel">
  <div id="content">
    <div class="empty-state">
      <h2>Select an item</h2>
      <p>Use the left menu to browse Articles and Recitals.</p>
    </div>
  </div>
</div>

<div class="right-panel">
  <h3>Further resources</h3>
  <div id="resources">
    <div class="empty-state">No item selected.</div>
  </div>
</div>

<script>
// Fixed: Using backticks (`) for multi-line strings
const rows = [
  {
    provision: "Recital 46",
    title: "[Explanations on Usage of Competing Business User Data",
    text: `In certain circumstances, a gatekeeper has a dual role as an undertaking providing core platform services, whereby it provides a core platform service, and possibly other services provided together with, or in support of, that core platform service to its business users, while also competing or intending to compete with those same business users in the provision of the same or similar services or products to the same end users. In those circumstances, a gatekeeper can take advantage of its dual role to use data, generated or provided by its business users in the context of activities by those business users when using the core platform services or the services provided together with, or in support of, those core platform services, for the purpose of its own services or products. The data of the business user can also include any data generated by or provided during the activities of its end users. This can be the case, for instance, where a gatekeeper provides an online marketplace or a software application store to business users, and at the same time provides services as an undertaking providing online retail services or software applications. To prevent gatekeepers from unfairly benefitting from their dual role, it is necessary to ensure that they do not use any aggregated or non-aggregated data, which could include anonymised and personal data that is not publicly available to provide similar services to those of their business users. That obligation should apply to the gatekeeper as a whole, including but not limited to its business unit that competes with the business users of a core platform service.`,
    links: ["Art. 6(2)"],
    info: {
      label: "Podszun, DMA Commentary, Art. 6(2)",
      url: "https://beck-online.beck.de/?vpath=bibdata%2Fkomm%2FPodKoDMA_1%2FEU_VO_2022_1925%2Fcont%2FPodKoDMA%2EEU_VO_2022_1925%2Ea6%2Ex2%2Ehtm"
    }
  },
  {
    provision: "Recital 51",
    title: "[Explanations on Self-preferencing]",
    text: `Gatekeepers are often vertically integrated and offer certain products or services to end users through their own core platform services, or through a business user over which they exercise control which frequently leads to conflicts of interest. This can include the situation whereby a gatekeeper provides its own online intermediation services through an online search engine. When offering those products or services on the core platform service, gatekeepers can reserve a better position, in terms of ranking, and related indexing and crawling, for their own offering than that of the products or services of third parties also operating on that core platform service. This can occur for instance with products or services, including other core platform services, which are ranked in the results communicated by online search engines, or which are partly or entirely embedded in online search engines results, groups of results specialised in a certain topic, displayed along with the results of an online search engine, which are considered or used by certain end users as a service distinct or additional to the online search engine.

Other instances are those of software applications which are distributed through software application stores, or videos distributed through a video-sharing platform, or products or services that are given prominence and display in the newsfeed of an online social networking service, or products or services ranked in search results or displayed on an online marketplace, or products or services offered through a virtual assistant. Such reserving of a better position of gatekeeper’s own offering can take place even before ranking following a query, such as during crawling and indexing. For example, already during crawling, as a discovery process by which new and updated content is being found, as well as indexing, which entails storing and organising of the content found during the crawling process, the gatekeeper can favour its own content over that of third parties. In those circumstances, the gatekeeper is in a dual-role position as intermediary for third-party undertakings and as undertaking directly providing products or services. Consequently, such gatekeepers have the ability to undermine directly the contestability for those products or services on those core platform services, to the detriment of business users which are not controlled by the gatekeeper.`,
    links: ["Art. 6(5)"],
    info: {
      label: "Podszun, DMA Commentary, Art. 6(5)",
      url: "https://beck-online.beck.de/?vpath=bibdata%2Fkomm%2FPodKoDMA_1%2FEU_VO_2022_1925%2Fcont%2FPodKoDMA%2EEU_VO_2022_1925%2Ea6%2Ex5%2Ehtm"
    }
  },
  {
    provision: "Recital 52",
    title: "[Explanations on Fair Ranking Conditions]",
    text: `In such situations, the gatekeeper should not engage in any form of differentiated or preferential treatment in ranking on the core platform service, and related indexing and crawling, whether through legal, commercial or technical means, in favour of products or services it offers itself or through a business user which it controls. To ensure that this obligation is effective, the conditions that apply to such ranking should also be generally fair and transparent. Ranking should in this context cover all forms of relative prominence, including display, rating, linking or voice results and should also include instances where a core platform service presents or communicates only one result to the end user. To ensure that this obligation is effective and cannot be circumvented, it should also apply to any measure that has an equivalent effect to the differentiated or preferential treatment in ranking. The guidelines adopted pursuant to Article 5 of Regulation (EU) 2019/1150 should also facilitate the implementation and enforcement of this obligation.`,
    links: ["Art. 6(5)"],
    info: {
      label: "Podszun, DMA Commentary, Art. 6(5)",
      url: "https://beck-online.beck.de/?vpath=bibdata%2Fkomm%2FPodKoDMA_1%2FEU_VO_2022_1925%2Fcont%2FPodKoDMA%2EEU_VO_2022_1925%2Ea6%2Ex5%2Ehtm"
    }
  },
  {
    provision: "Art. 6(2)",
    title: "[Restriction on Using Business User Data]",
    text: `The gatekeeper shall not use, in competition with business users, any data that is not publicly available that is generated or provided by those business users in the context of their use of the relevant core platform services or of the services provided together with, or in support of, the relevant core platform services, including data generated or provided by the customers of those business users.

For the purposes of the first subparagraph, the data that is not publicly available shall include any aggregated and non-aggregated data generated by business users that can be inferred from, or collected through, the commercial activities of business users or their customers.`,
    links: ["Recital 46"],
    info: {
      label: "Podszun, DMA Commentary, Art. 6(2)",
      url: "https://beck-online.beck.de/?vpath=bibdata%2Fkomm%2FPodKoDMA_1%2FEU_VO_2022_1925%2Fcont%2FPodKoDMA%2EEU_VO_2022_1925%2Ea6%2Ex2%2Ehtm"
    }
  },
  {
    provision: "Art. 6(5)",
    title: "[Prohibition of Self-preferencing in Ranking]",
    text: `The gatekeeper shall not treat more favourably, in ranking and related indexing and crawling, services and products offered by the gatekeeper itself than similar services or products of a third party. The gatekeeper shall apply transparent, fair and non-discriminatory conditions to such ranking.`,
    links: ["Recital 51", "Recital 52"],
    info: {
      label: "Podszun, DMA Commentary, Art. 6(5)",
      url: "https://beck-online.beck.de/?vpath=bibdata%2Fkomm%2FPodKoDMA_1%2FEU_VO_2022_1925%2Fcont%2FPodKoDMA%2EEU_VO_2022_1925%2Ea6%2Ex5%2Ehtm"
    }
  }
];

function renderNav() {
  const nav = document.getElementById("nav");
  nav.innerHTML = rows.map(r => `
    <div class="obligation-link" id="nav-${r.provision.replace(/[.()\s]/g, '-')}" onclick="loadItem('${r.provision}')">
      <strong>${r.provision}</strong>
    </div>
  `).join('');
}

function loadItem(prov) {
  const item = rows.find(r => r.provision === prov);
  if (!item) return;

  document.querySelectorAll('.obligation-link').forEach(el => el.classList.remove('active'));
  const activeLink = document.getElementById(`nav-${prov.replace(/[.()\s]/g, '-')}`);
  if(activeLink) activeLink.classList.add('active');

  const linksHtml = item.links.map(l => `<a class="ref-link" onclick="loadItem('${l.trim()}')">${l.trim()}</a>`).join('');
  
  document.getElementById('content').innerHTML = `
    <div class="title">${item.provision}: ${item.title}</div>
    <div class="link-section"><strong>Linked Provision(s):</strong> ${linksHtml}</div>
    <div class="provision-text">${item.text}</div>
  `;

  const resDiv = document.getElementById('resources');
  if (item.info) {
    resDiv.innerHTML = `
      <div class="resource-card">
        <strong>Official Commentary</strong>
        <p>${item.info.label}</p>
        <a href="${item.info.url}" target="_blank">View on Beck-Online ↗</a>
      </div>
    `;
  } else {
    resDiv.innerHTML = `<div class="empty-state">No specific commentary linked.</div>`;
  }
}

// Ensure the navigation renders on page load
renderNav();
</script>
</body>
</html>
