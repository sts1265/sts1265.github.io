<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DMA Explorer Prototype - Side-by-Side</title>
  <style>
    :root {
      --primary: #0f2a44;
      --accent: #1f6feb;
      --bg-light: #f7f9fc;
      --border: #d6e0ef;
    }

    body { 
      margin: 0; 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      display: grid; 
      grid-template-columns: 260px 1fr 1fr; /* Equal width for center and right panels */
      height: 100vh; 
      background: var(--bg-light); 
      overflow: hidden;
    }

    /* Panels */
    .panel { overflow-y: auto; padding: 30px; height: 100vh; box-sizing: border-box; }
    
    .left-panel { background: var(--primary); color: white; padding: 20px; border-right: 1px solid #081a2b; grid-column: 1; }
    .center-panel { background: white; border-right: 1px solid var(--border); grid-column: 2; }
    .right-panel { background: #f0f4f8; grid-column: 3; position: relative; }

    /* Typography */
    h3 { margin-top: 0; color: #9ec3ff; font-size: 1rem; text-transform: uppercase; border-bottom: 1px solid #1f4c7a; padding-bottom: 10px; }
    .title { font-size: 1.4rem; font-weight: 800; color: var(--primary); margin-bottom: 10px; }
    .provision-text { font-size: 1rem; line-height: 1.6; white-space: pre-wrap; color: #333; }
    
    /* Navigation Links */
    .obligation-link { 
      padding: 12px; margin-bottom: 8px; background: #173a5e; border-radius: 6px; 
      cursor: pointer; font-size: 0.85rem; transition: 0.2s;
    }
    .obligation-link:hover { background: #1f4c7a; }
    .obligation-link.active { background: var(--accent); font-weight: bold; }

    /* Inline Links */
    .link-section { margin: 15px 0; padding: 10px; background: #eef3f9; border-radius: 8px; font-size: 0.9rem; }
    .ref-link { 
      display: inline-block; margin: 4px; padding: 4px 12px; background: var(--accent); 
      color: white; text-decoration: none; border-radius: 20px; cursor: pointer; font-weight: 600;
    }
    
    /* UI Components */
    .close-btn { position: absolute; top: 15px; right: 15px; cursor: pointer; background: #ccc; border: none; border-radius: 50%; width: 25px; height: 25px; font-weight: bold; }
    .resource-card { background: white; padding: 15px; border-radius: 8px; border: 1px solid var(--border); margin-top: 20px; }
    .resource-card a { color: var(--accent); font-weight: bold; text-decoration: none; }
    .empty-state { color: #888; font-style: italic; text-align: center; margin-top: 100px; }
    .panel-label { font-size: 0.7rem; font-weight: bold; color: #aaa; text-transform: uppercase; margin-bottom: 20px; display: block;}
  </style>
</head>
<body>

<div class="panel left-panel">
  <h3>DMA Provisions</h3>
  <div id="nav"></div>
</div>

<div class="panel center-panel" id="primary-view">
  <span class="panel-label">Primary Selection</span>
  <div id="primary-content">
    <div class="empty-state">Select a provision from the left menu to begin.</div>
  </div>
</div>

<div class="panel right-panel" id="reference-view">
  <button class="close-btn" onclick="clearRef()">×</button>
  <span class="panel-label">Reference View</span>
  <div id="reference-content">
    <div class="empty-state">Click a link in the main text to compare related provisions here.</div>
  </div>
</div>

<script>
const rows = [
  {
    provision: "Recital 46",
    title: "[Explanations on Usage of Business User Data]",
    text: `In certain circumstances, a gatekeeper has a dual role as an undertaking providing core platform services... To prevent gatekeepers from unfairly benefitting from their dual role, it is necessary to ensure that they do not use any aggregated or non-aggregated data...`,
    links: ["Art. 6(2)"],
    info: { label: "Podszun, DMA Commentary, Art. 6(2)", url: "https://beck-online.beck.de/..." }
  },
  {
    provision: "Recital 51",
    title: "[Explanations on Self-preferencing]",
    text: `Gatekeepers are often vertically integrated... When offering those products or services on the core platform service, gatekeepers can reserve a better position, in terms of ranking, and related indexing and crawling, for their own offering...`,
    links: ["Art. 6(5)"],
    info: { label: "Podszun, DMA Commentary, Art. 6(5)", url: "https://beck-online.beck.de/..." }
  },
  {
    provision: "Recital 52",
    title: "[Explanations on Fair Ranking Conditions]",
    text: `In such situations, the gatekeeper should not engage in any form of differentiated or preferential treatment in ranking... Ranking should in this context cover all forms of relative prominence...`,
    links: ["Art. 6(5)"],
    info: { label: "Podszun, DMA Commentary, Art. 6(5)", url: "https://beck-online.beck.de/..." }
  },
  {
    provision: "Art. 6(2)",
    title: "[Restriction on Using Business User Data]",
    text: `The gatekeeper shall not use, in competition with business users, any data that is not publicly available that is generated or provided by those business users...`,
    links: ["Recital 46"],
    info: { label: "Podszun, DMA Commentary, Art. 6(2)", url: "https://beck-online.beck.de/..." }
  },
  {
    provision: "Art. 6(5)",
    title: "[Prohibition of Self-preferencing in Ranking]",
    text: `The gatekeeper shall not treat more favourably, in ranking and related indexing and crawling, services and products offered by the gatekeeper itself than similar services or products of a third party.`,
    links: ["Recital 51", "Recital 52"],
    info: { label: "Podszun, DMA Commentary, Art. 6(5)", url: "https://beck-online.beck.de/..." }
  }
];

function renderNav() {
  const nav = document.getElementById("nav");
  nav.innerHTML = rows.map(r => `
    <div class="obligation-link" id="nav-${r.provision.replace(/[.()\s]/g, '-')}" onclick="loadPrimaryItem('${r.provision}')">
      <strong>${r.provision}</strong>
    </div>
  `).join('');
}

// Loads the main item into the Center Column
function loadPrimaryItem(prov) {
  const item = rows.find(r => r.provision === prov);
  if (!item) return;

  document.querySelectorAll('.obligation-link').forEach(el => el.classList.remove('active'));
  document.getElementById(`nav-${prov.replace(/[.()\s]/g, '-')}`).classList.add('active');

  const linksHtml = item.links.map(l => `<a class="ref-link" onclick="loadReferenceItem('${l.trim()}')">${l.trim()}</a>`).join('');
  
  document.getElementById('primary-content').innerHTML = `
    <div class="title">${item.provision}</div>
    <div class="provision-text"><strong>${item.title}</strong></div>
    <div class="link-section"><strong>Related references (click to open side-by-side):</strong><br>${linksHtml}</div>
    <div class="provision-text">${item.text}</div>
  `;
}

// Loads the linked item into the Right Column
function loadReferenceItem(prov) {
  const item = rows.find(r => r.provision === prov);
  if (!item) return;

  document.getElementById('reference-content').innerHTML = `
    <div class="title" style="font-size: 1.1rem;">${item.provision}</div>
    <div class="provision-text" style="font-size: 0.9rem;"><strong>${item.title}</strong></div>
    <hr border="0" style="border-top:1px solid #ddd; margin:15px 0;">
    <div class="provision-text" style="font-size: 0.9rem;">${item.text}</div>
    ${item.info ? `
      <div class="resource-card">
        <strong>Commentary</strong><br>
        <a href="${item.info.url}" target="_blank">View on Beck-Online ↗</a>
      </div>` : ''}
  `;
}

function clearRef() {
  document.getElementById('reference-content').innerHTML = `<div class="empty-state">Click a link in the main text to compare related provisions here.</div>`;
}

renderNav();
</script>
</body>
</html>
